#!/usr/bin/env node
'use strict'

process.env.NODE_PATH = __dirname + '/../node_modules/'

const program = require('commander')
const shell = require('shelljs')
const path = require('path')
const packageObj = require('../package')

program
  .version(`${packageObj.version}/official ${packageObj.weVersion}/nwjs ${packageObj.nwjsVersion}`)

program
  .usage('<command>')

program
  .command('start [--debug]', '启动微信web开发者工具', { isDefault: true })
  .option('-D, --debug [port]', '开启debug模式', /^[1-9]\d{1,3}$/)
  .action((name, commond) => {
    let execCommon = path.resolve(__dirname, '../dist/nw')
    if (commond.debug) {
      const port = commond.debug === true
        ? 9222
        : commond.debug

      execCommon += ` --remote-debugging-port=${port}`
      console.info(`remote-debugging-port @ ${port}`)
    }
    shell.exec(execCommon)
  })

program.parse(process.argv)
